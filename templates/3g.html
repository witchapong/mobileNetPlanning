<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PCI planning</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.5/socket.io.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function() {

            namespace='/plan_3g';

            var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);

            socket.on('connect', function() {
                $('#log').append('Client connected...'+'<br>');
            });

            socket.on('progress', function() {

            });

            socket.on('disconnect', function() {
                $('#log').append('Client disconnected...'+'<br>');
            });

            socket.on('plan finished', function() {
                $("#downloadButton").removeAttr("disabled");
            });

            socket.on('plan error', function() {
                $('#log').append('Plan error. Please contact admin.'+'<br>');
            });

            $('form#plan').submit(function(event) {
                $('#log').append('Plan submitted...'+'<br>');
                socket.emit('plan',{rCol:$('#rCol').val(),rMin:$('#rMin').val()});
                return false;
            });

        });
    </script>

</head>
<body>

    <div class="container">
        <div class="jumbotron">
            <h1 class="display-4">PSC planning application</h1>
            <h2>Instruction</h2>
            <ol>
                <li>Upload your plan file which should contain all required columns shown below. Now the app supports only .xlsx file.</li>
                <li>Press the plan button and wait until completion</li>
                <li>Download output files</li>
            </ol>
            <h2>Required columns and description</h2>
            <table class="table table-striped">
                <tr>
                    <th>Column name</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td>PSC</td>
                    <td>Insert PSC = -1 for cells to plan PSC</td>
                </tr>
                <tr>
                    <td>LAT</td>
                    <td>Latitude of a cell</td>
                </tr>
                <tr>
                    <td>LNG</td>
                    <td>Longitude of a cell</td>
                </tr>
                <tr>
                    <td>DIRECTION</td>
                    <td>Direction of a cell. For Pico cells, use -1.</td>
                </tr>
                <tr>
                    <td>AREA_TYPE</td>
                    <td>Whether a cell is in 'inner','outer', or 'border' area.<br>
                        For new cells, You can leave them blank for the app to calculate them for you.<br>
                        Possible values: ['inner','outer','border']
                    </td>
                </tr>
                <tr>
                    <td>SITE_TYPE</td>
                    <td>Whether a site type of a cell is 'macro','micro',or 'pico'.<br>
                    Possible values: ['macro','micro','pico']
                    </td>
                </tr>
            </table>
            <hr class="my-4">
            <h2>Upload your plan file</h2>

            <form action="{{url_for('upload_3g')}}" method="POST" enctype="multipart/form-data">
                <div class="custom-file">
                    <input type="file" class="custom-file-input" accept=".xlsx" name="file" id="customFile" required>
                    <label class="custom-file-label" for="customFile">Choose file</label>
                </div>
                    <script>
                        $('#customFile').on('change',function(){
                            //get the file name
                            var fileName = $(this).val();
                            //replace the "Choose a file" label
                            $(this).next('.custom-file-label').html(fileName);
                            //$('.custom-file-label').text(fileName);
                        })
                    </script>
                <br>
                <button type="submit" class="btn btn-primary">Upload</button>
            </form>
            <br>
            <h2>Specify your plan parameters</h2>
            <form id = "plan" action="#" method="POST">
              <div class="form-group">
                <label for="rCol">Collision avoiding radius (m)</label>
                <input type="number" class="form-control" id="rCol" name="rCol" placeholder="5000">
              </div>
              <div class="form-group">
                <label for="rMin">Minimum reused distance (m)</label>
                <input type="number" class="form-control" id="rMin" name="rMin" placeholder="100">
              </div>
              <button type="submit" class="btn btn-secondary">Plan</button>
            </form>
            <br>
            <a href={{url_for('download_3g')}} target="blank"><button type="button"  id = "downloadButton" class="btn btn-success" disabled>Download</button></a>
            <div id="log"><b>Program log:</b><br></div>

            </div>
        </div>
    </div>

</body>
</html>